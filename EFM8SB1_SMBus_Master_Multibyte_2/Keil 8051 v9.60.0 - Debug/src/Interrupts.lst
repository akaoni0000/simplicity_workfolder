C51 COMPILER V9.60.0.0   INTERRUPTS                                                        09/14/2024 21:52:31 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE INTERRUPTS
OBJECT MODULE PLACED IN .\src\Interrupts.OBJ
COMPILER INVOKED BY: C:\SiliconLabs\SimplicityStudio\v5\developer\toolchains\keil_8051\9.60\BIN\C51.exe C:\Users\Yoshida
                    -_Lab\SimplicityStudio\v5_workspace\EFM8SB1_SMBus_Master_Multibyte_2\src\Interrupts.c OMF2 SMALL DEBUG OBJECTEXTEND ROM(L
                    -ARGE) WARNINGLEVEL(2) FLOATFUZZY(3) OPTIMIZE(8,SPEED) DEFINE(DEBUG=1) INTVECTOR(0X0000) INTPROMOTE INCDIR(C:\Users\Yoshi
                    -da_Lab\SimplicityStudio\v5_workspace\EFM8SB1_SMBus_Master_Multibyte_2\inc;C:/SiliconLabs/SimplicityStudio/v5/developer/s
                    -dks/8051/v4.3.1//Device/shared/si8051Base;C:/SiliconLabs/SimplicityStudio/v5/developer/sdks/8051/v4.3.1//Device/EFM8SB1/
                    -inc) PRINT(.\src\Interrupts.lst) COND PAGEWIDTH(120) PAGELENGTH(65) OBJECT(.\src\Interrupts.OBJ)

line level    source

   1          #include <SI_EFM8SB1_Register_Enums.h>
   2          #include "EFM8SB1_SMBus_Master_Multibyte.h"
   3          int aaa=0;
   4          extern bbb;
   5          extern start_flag;
   6          extern data_count;
   7          extern LCD_RS;
   8          //-----------------------------------------------------------------------------
   9          SI_INTERRUPT(SMBUS0_ISR, SMBUS0_IRQn)
  10          {
  11   1        bool FAIL = 0;
  12   1        static uint8_t sent_byte_counter;
  13   1        static uint8_t rec_byte_counter;
  14   1      
  15   1        if (SMB0CN0_ARBLOST == 0)                   // Check for errors
  16   1        {
  17   2          switch (SMB0CN0 & 0xF0)           // Status vector
  18   2          {
  19   3           // Master Transmitter/Receiver: START condition transmitted.
  20   3           case SMB_MTSTA:
  21   3            SMB0DAT = 0x7C;
  22   3            SMB0CN0_STA = 0;                   // Manually clear START bit
  23   3            rec_byte_counter = 0;      // Reset the counter
  24   3            sent_byte_counter = 0;     // Reset the counter
  25   3            break;
  26   3      
  27   3           case SMB_MTDB:
  28   3            if (SMB0CN0_ACK)                   // Slave SMB0CN0_ACK?
  29   3            {
  30   4                if (sent_byte_counter <= 1)
  31   4                {
  32   5                           if(sent_byte_counter == 0){
  33   6                               if(LCD_RS==0){
  34   7                                   SMB0DAT = 0x00;
  35   7                               }
  36   6                               else if(LCD_RS==1){
  37   7                                   SMB0DAT = 0x40;
  38   7                               }
  39   6                           }
  40   5                           else if(sent_byte_counter == 1){
  41   6                               SMB0DAT = SMB_DATA_OUT[0];
  42   6                           }
  43   5                           sent_byte_counter++;
  44   5                }
  45   4                else
  46   4                {
  47   5                    SMB0CN0_STO = 1;          // Set SMB0CN0_STO to terminate transfer
  48   5                               //SMB_BUSY = 0;     // And free SMBus interface
  49   5                }
  50   4            }
  51   3            break;
C51 COMPILER V9.60.0.0   INTERRUPTS                                                        09/14/2024 21:52:31 PAGE 2   

  52   3          } // end switch
  53   2        }
  54   1      
  55   1        SMB0CN0_SI = 0;                             // Clear interrupt flag
  56   1      }
  57          
  58          
  59          
  60          
  61          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    113    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      4    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----       1
   EDATA SIZE       =   ----    ----
   HDATA SIZE       =   ----    ----
   XDATA CONST SIZE =   ----    ----
   FAR CONST SIZE   =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
